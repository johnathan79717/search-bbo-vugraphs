= stylesheet_link_tag 'index'

%h1 Search Fantunes
%p This website is for those who are interested in the Fantunes system. You can search for any bidding sequence from the vugraph files of Fantoni and Nunes.
%p by Po-Hsiang Hao, a Taiwanese student, bbo id: johnathan, any advice or suggestions please email johnathan79717@gmail.com
%p Last update: 2014/01/13
%p pass = '-', double = 'X', redouble = 'XX', bids should be separated by space.
= form_tag({}, :method => :get) do
  %h3 Enter the bidding sequence you want to search: (e.g. 1C X XX or 1C - 1D - 1N)
  = text_field_tag :sequence
  = submit_tag 'Search'
%h2= "#{@boards.size} results for #{@sequence}" if @sequence
- @boards.each do |board|
  %h3= link_to "#{board.event}, Board #{board.number}", "http://www.bridgebase.com/tools/handviewer.html?linurl=#{board.link}", :target => '_blank'
  - hands = board.hands.split(',')
  - players = board.players.split(',')
  - nsVul, ewVul = vul(board.number)
  - nDealer, eDealer, sDealer, wDealer = dealer(board.number)
  %table
    %tr
      %td.board
        %table.num
          %tr
            %td.corner
            %td{:class => nsVul}= nDealer
            %td.corner
          %tr
            %td{:class => ewVul}= wDealer
            %td.num= board.number
            %td{:class => ewVul}= eDealer
          %tr
            %td.corner
            %td{:class => nsVul}= sDealer
            %td.corner
      %td.board= print_hand(players[2], hands[2])
      %td.board
    %tr
      %td.board= print_hand(players[1], hands[1])
      %td.board
      %td.board= print_hand(players[3], hands[3])
    %tr
      %td.board
      %td.board= print_hand(players[0], hands[0])
  %br
  %table
    %tr
      %td.bid W
      %td.bid N
      %td.bid E
      %td.bid S
    %tr
      - shift = board.number % 4
      - shift.times do
        %td.bid
      - board.auction.split(' ').each_with_index do |bid, n|
        - if (n + shift) % 4 == 0 && n != 0
          %tr
        %td.bid= to_figure(bid)
  %p
    - board.explanation.split('\n').each do |item|
      = to_figure(item)
      %br


